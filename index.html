<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .stat-card {
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .sidebar-item {
            transition: all 0.3s ease;
        }
        .sidebar-item:hover {
            background-color: #f3f4f6;
            transform: translateX(-5px);
        }
        .sidebar-item.active {
            background-color: #3b82f6;
            color: white;
        }
        .order-card {
            transition: all 0.3s ease;
        }
        .order-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .dropdown-transition {
            transition: all 0.3s ease;
        }
        
        /* Modal animations */
        .modal-enter {
            animation: modalEnter 0.3s ease-out;
        }
        
        @keyframes modalEnter {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .modal-exit {
            animation: modalExit 0.2s ease-in;
        }
        
        @keyframes modalExit {
            from {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
            to {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .sidebar-item {
                transform: none;
            }
            .sidebar-item:hover {
                transform: none;
            }
            .stat-card:hover {
                transform: none;
            }
            .order-card:hover {
                transform: none;
            }
            .mobile-scroll {
                overflow-x: auto;
            }
            .mobile-grid {
                min-width: 300px;
            }
        }
        
        /* Sidebar mobile styles */
        @media (max-width: 1024px) {
            .sidebar-mobile {
                transform: translateX(100%);
            }
            .sidebar-mobile.open {
                transform: translateX(0);
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-indigo-100 min-h-screen">
    
    <!-- Dashboard Section -->
    <div id="dashboardSection">
        <!-- Header -->
        <header class="bg-white shadow-lg border-b-4 border-purple-500 fixed w-full top-0 z-40">
            <div class="px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4 lg:py-6">
                    <div class="flex items-center">
                        <button onclick="toggleSidebar()" class="lg:hidden ml-2 p-2 rounded-md text-gray-600 hover:text-gray-900">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                        </button>
                        <h1 class="text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900">ğŸ‘¨â€ğŸ’¼ Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</h1>
                    </div>
                    <div class="flex items-center space-x-2 sm:space-x-4 space-x-reverse">
                        <span class="text-gray-600 text-sm sm:text-base hidden sm:block">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø£Ø¯Ù…Ù†</span>
                        <div class="w-8 h-8 sm:w-10 sm:h-10 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold text-sm sm:text-base">
                            Ø£
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <div id="sidebar" class="fixed right-0 top-16 sm:top-20 h-full w-64 bg-white shadow-lg transform sidebar-mobile transition-transform duration-300 ease-in-out z-30 lg:translate-x-0">
            <div class="p-6">
                <nav class="space-y-2">
                    <a href="#" onclick="showSection('stats')" class="sidebar-item active flex items-center px-4 py-3 rounded-lg">
                        <span class="ml-3">ğŸ“Š</span>
                        Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                    </a>
                    <div class="relative">
                        <button onclick="toggleOrdersDropdown()" class="sidebar-item flex items-center justify-between px-4 py-3 rounded-lg w-full text-right">
                            <div class="flex items-center">
                                <span class="ml-3">ğŸ“‹</span>
                                Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª
                            </div>
                            <span id="ordersDropdownIcon" class="transform transition-transform dropdown-transition">â–¼</span>
                        </button>
                        <div id="ordersDropdown" class="hidden mt-2 mr-6 space-y-1 dropdown-transition">
                            <a href="#" onclick="showOrdersSection('pending')" class="sidebar-item flex items-center px-4 py-2 rounded-lg text-sm">
                                <span class="ml-3">ğŸšš</span>
                                Ø·Ù„Ø¨Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„
                            </a>
                            <a href="#" onclick="showOrdersSection('delivered')" class="sidebar-item flex items-center px-4 py-2 rounded-lg text-sm">
                                <span class="ml-3">âœ…</span>
                                Ø·Ù„Ø¨Ø§Øª ØªÙ… ØªØ³Ù„ÙŠÙ…Ù‡Ø§
                            </a>
                            <a href="#" onclick="showOrdersSection('returned')" class="sidebar-item flex items-center px-4 py-2 rounded-lg text-sm">
                                <span class="ml-3">â†©ï¸</span>
                                Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø±Ø§Ø¬Ø¹Ø©
                            </a>
                        </div>
                    </div>
                    <a href="#" onclick="showSection('users')" class="sidebar-item flex items-center px-4 py-3 rounded-lg">
                        <span class="ml-3">ğŸ‘¥</span>
                        Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                    </a>
                    <a href="#" onclick="showSection('withdrawals')" class="sidebar-item flex items-center px-4 py-3 rounded-lg">
                        <span class="ml-3">ğŸ’°</span>
                        Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨
                    </a>
                </nav>
            </div>
        </div>

        <!-- Overlay for mobile -->
        <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden lg:hidden" onclick="toggleSidebar()"></div>

        <!-- Main Content -->
        <div class="lg:mr-64 pt-16 sm:pt-20">
            <div class="px-4 sm:px-6 lg:px-8 py-4 sm:py-8">
                
                <!-- Statistics Section -->
                <div id="statsSection" class="section-content">
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 sm:mb-6">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-4 sm:mb-6">
                        <div class="stat-card bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 sm:p-6 text-white">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-blue-100 text-xs sm:text-sm">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</p>
                                    <p class="text-2xl sm:text-3xl font-bold" id="totalOrders">0</p>
                                </div>
                                <div class="text-2xl sm:text-4xl">ğŸ“¦</div>
                            </div>
                        </div>
                        <div class="stat-card bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-4 sm:p-6 text-white">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-green-100 text-xs sm:text-sm">ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…</p>
                                    <p class="text-2xl sm:text-3xl font-bold" id="deliveredOrders">0</p>
                                </div>
                                <div class="text-2xl sm:text-4xl">âœ…</div>
                            </div>
                        </div>
                        <div class="stat-card bg-gradient-to-r from-red-500 to-red-600 rounded-xl p-4 sm:p-6 text-white">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-red-100 text-xs sm:text-sm">Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø±Ø§Ø¬Ø¹Ø©</p>
                                    <p class="text-2xl sm:text-3xl font-bold" id="returnedOrders">0</p>
                                </div>
                                <div class="text-2xl sm:text-4xl">â†©ï¸</div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Pending Orders Section -->
                <div id="pendingOrdersSection" class="section-content hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">ğŸšš Ø·Ù„Ø¨Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„</h2>
                        <div class="flex space-x-4 space-x-reverse">
                            <input 
                                type="text" 
                                id="searchPendingInput" 
                                placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª..."
                                class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                            >
                            <button onclick="searchOrders('pending')" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors">
                                Ø¨Ø­Ø«
                            </button>
                        </div>
                    </div>
                    
                    <div id="pendingOrdersContainer" class="space-y-4">
                        <!-- Pending orders will be loaded here -->
                    </div>
                    
                    <div id="noPendingOrders" class="text-center py-12 hidden">
                        <div class="text-6xl mb-4">ğŸšš</div>
                        <p class="text-gray-500 text-lg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„</p>
                    </div>
                </div>

                <!-- Delivered Orders Section -->
                <div id="deliveredOrdersSection" class="section-content hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">âœ… Ø·Ù„Ø¨Ø§Øª ØªÙ… ØªØ³Ù„ÙŠÙ…Ù‡Ø§</h2>
                        <div class="flex space-x-4 space-x-reverse">
                            <input 
                                type="text" 
                                id="searchDeliveredInput" 
                                placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª..."
                                class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                            >
                            <button onclick="searchOrders('delivered')" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors">
                                Ø¨Ø­Ø«
                            </button>
                        </div>
                    </div>
                    
                    <div id="deliveredOrdersContainer" class="space-y-4">
                        <!-- Delivered orders will be loaded here -->
                    </div>
                    
                    <div id="noDeliveredOrders" class="text-center py-12 hidden">
                        <div class="text-6xl mb-4">âœ…</div>
                        <p class="text-gray-500 text-lg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø³Ù„Ù…Ø©</p>
                    </div>
                </div>

                <!-- Returned Orders Section -->
                <div id="returnedOrdersSection" class="section-content hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">â†©ï¸ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø±Ø§Ø¬Ø¹Ø©</h2>
                        <div class="flex space-x-4 space-x-reverse">
                            <input 
                                type="text" 
                                id="searchReturnedInput" 
                                placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª..."
                                class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                            >
                            <button onclick="searchOrders('returned')" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors">
                                Ø¨Ø­Ø«
                            </button>
                        </div>
                    </div>
                    
                    <div id="returnedOrdersContainer" class="space-y-4">
                        <!-- Returned orders will be loaded here -->
                    </div>
                    
                    <div id="noReturnedOrders" class="text-center py-12 hidden">
                        <div class="text-6xl mb-4">â†©ï¸</div>
                        <p class="text-gray-500 text-lg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø±Ø§Ø¬Ø¹Ø©</p>
                    </div>
                </div>

                <!-- Users Management Section -->
                <div id="usersSection" class="section-content hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
                        <button onclick="showAddUserModal()" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                            Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                    
                    <div id="usersContainer" class="space-y-4">
                        <!-- Users will be loaded here -->
                    </div>
                </div>

                <!-- Withdrawals Section -->
                <div id="withdrawalsSection" class="section-content hidden">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">ğŸ’° Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨</h2>
                    
                    <div id="withdrawalsContainer" class="space-y-4">
                        <!-- Withdrawal requests will be loaded here -->
                    </div>
                    
                    <div id="noWithdrawals" class="text-center py-12 hidden">
                        <div class="text-6xl mb-4">ğŸ’°</div>
                        <p class="text-gray-500 text-lg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div id="addUserModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl p-4 sm:p-6 w-full max-w-md max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4 sm:mb-6">
                <h3 class="text-lg sm:text-xl font-bold text-gray-900">Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯</h3>
                <button onclick="closeAddUserModal()" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
            </div>
            <form id="addUserForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… *</label>
                    <input type="text" id="newUsername" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm sm:text-base">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± *</label>
                    <input type="password" id="newPassword" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm sm:text-base">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† *</label>
                    <input type="text" id="newAddress" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm sm:text-base">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø£ÙˆÙ„ *</label>
                    <input type="tel" id="newPhone1" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm sm:text-base">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø«Ø§Ù†ÙŠ *</label>
                    <input type="tel" id="newPhone2" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm sm:text-base">
                </div>
                <div class="flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-4 sm:space-x-reverse pt-4">
                    <button type="button" onclick="closeAddUserModal()" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 text-sm sm:text-base">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="submit" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 text-sm sm:text-base">
                        Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit User Modal -->
    <div id="editUserModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl p-4 sm:p-6 w-full max-w-md max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4 sm:mb-6">
                <h3 class="text-lg sm:text-xl font-bold text-gray-900">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h3>
                <button onclick="closeEditUserModal()" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
            </div>
            <form id="editUserForm" class="space-y-4">
                <input type="hidden" id="editUserId">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… *</label>
                    <input type="text" id="editUserUsername" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm sm:text-base">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© *</label>
                    <input type="text" id="editUserPassword" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm sm:text-base">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† *</label>
                    <input type="text" id="editUserAddress" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm sm:text-base">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø£ÙˆÙ„ *</label>
                    <input type="tel" id="editUserPhone1" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm sm:text-base">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø«Ø§Ù†ÙŠ *</label>
                    <input type="tel" id="editUserPhone2" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm sm:text-base">
                </div>
                <div class="flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-4 sm:space-x-reverse pt-4">
                    <button type="button" onclick="closeEditUserModal()" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 text-sm sm:text-base">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="submit" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 text-sm sm:text-base">
                        Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md transform transition-all duration-300 scale-95">
            <div class="text-center">
                <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 mb-4">
                    <svg class="h-8 w-8 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-4">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</h3>
                <p class="text-gray-600 mb-6 leading-relaxed" id="confirmMessage">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ù‡Ø°Ø§ØŸ</p>
                <div class="flex justify-center space-x-4 space-x-reverse">
                    <button onclick="closeConfirmModal()" class="px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all duration-200 font-medium">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button id="confirmButton" class="px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-all duration-200 font-medium shadow-lg hover:shadow-xl">
                        ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Message Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md transform transition-all duration-300 scale-95">
            <div class="text-center">
                <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-4">
                    <svg class="h-8 w-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-4">ØªÙ… Ø¨Ù†Ø¬Ø§Ø­!</h3>
                <p class="text-gray-600 mb-6 leading-relaxed" id="successMessage">ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­</p>
                <button onclick="closeSuccessModal()" class="px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all duration-200 font-medium shadow-lg hover:shadow-xl">
                    Ù…ÙˆØ§ÙÙ‚
                </button>
            </div>
        </div>
    </div>

    <!-- Error Message Modal -->
    <div id="errorModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl p-6 w-full max-w-md transform transition-all duration-300 scale-95">
            <div class="text-center">
                <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 mb-4">
                    <svg class="h-8 w-8 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-4">Ø­Ø¯Ø« Ø®Ø·Ø£!</h3>
                <p class="text-gray-600 mb-6 leading-relaxed" id="errorMessage">Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹</p>
                <button onclick="closeErrorModal()" class="px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-all duration-200 font-medium shadow-lg hover:shadow-xl">
                    Ù…ÙˆØ§ÙÙ‚
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Order Modal -->
    <div id="editModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 w-full max-w-2xl mx-4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-gray-900">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨</h3>
                <button onclick="closeEditModal()" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
            </div>
            <form id="editForm" class="space-y-4">
                <input type="hidden" id="editOrderId">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
                        <input type="text" id="editAddress" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø£ÙˆÙ„</label>
                        <input type="tel" id="editPhone1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø«Ø§Ù†ÙŠ</label>
                        <input type="tel" id="editPhone2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ù…Ø¨Ù„Øº Ø§Ù„Ø·Ù„Ø¨</label>
                        <input type="number" id="editAmount" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                    </div>
                </div>
                <div class="flex justify-end space-x-4 space-x-reverse pt-4">
                    <button type="button" onclick="closeEditModal()" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="submit" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">
                        Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBKh3zoKYEbm7aGNH6GRzA5SQx4DYhM7gc",
            authDomain: "arpon11-a4ead.firebaseapp.com",
            databaseURL: "https://arpon11-a4ead-default-rtdb.firebaseio.com",
            projectId: "arpon11-a4ead",
            storageBucket: "arpon11-a4ead.firebasestorage.app",
            messagingSenderId: "231633090493",
            appId: "1:231633090493:web:d0c1973bd13b58f7b044d4",
            measurementId: "G-8YJ5394ZP8"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        let allOrders = [];
        let pendingOrders = [];
        let deliveredOrders = [];
        let returnedOrders = [];
        let allUsers = [];
        let allWithdrawals = [];

        // Initialize dashboard on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadOrders();
            loadUsers();
            loadWithdrawals();
        });



        // Toggle orders dropdown
        function toggleOrdersDropdown() {
            const dropdown = document.getElementById('ordersDropdown');
            const icon = document.getElementById('ordersDropdownIcon');
            
            if (dropdown.classList.contains('hidden')) {
                dropdown.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                dropdown.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
            }
        }

        // Show orders section by type
        function showOrdersSection(type) {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(el => {
                el.classList.add('hidden');
            });
            
            // Remove active class from all sidebar items
            document.querySelectorAll('.sidebar-item').forEach(el => {
                el.classList.remove('active');
            });
            
            // Show selected orders section
            document.getElementById(type + 'OrdersSection').classList.remove('hidden');
            
            // Add active class to clicked item
            event.target.classList.add('active');
            
            // Load orders by type
            loadOrdersByType(type);
        }

        // Show/Hide sections
        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(el => {
                el.classList.add('hidden');
            });
            
            // Remove active class from all sidebar items
            document.querySelectorAll('.sidebar-item').forEach(el => {
                el.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(section + 'Section').classList.remove('hidden');
            
            // Add active class to clicked sidebar item
            event.target.classList.add('active');
            
            // Hide orders dropdown when other sections are selected
            if (section !== 'orders') {
                document.getElementById('ordersDropdown').classList.add('hidden');
                document.getElementById('ordersDropdownIcon').style.transform = 'rotate(0deg)';
            }
        }

        // Toggle sidebar for mobile
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            if (sidebar.classList.contains('open')) {
                sidebar.classList.remove('open');
                overlay.classList.add('hidden');
            } else {
                sidebar.classList.add('open');
                overlay.classList.remove('hidden');
            }
        }

        // Load orders
        function loadOrders() {
            database.ref('orders').on('value', (snapshot) => {
                allOrders = [];
                if (snapshot.exists()) {
                    snapshot.forEach((childSnapshot) => {
                        const order = {
                            id: childSnapshot.key,
                            ...childSnapshot.val()
                        };
                        allOrders.push(order);
                    });
                }
                categorizeOrders();
                updateStatistics();
            });
        }

        // Categorize orders by status
        function categorizeOrders() {
            pendingOrders = allOrders.filter(order => 
                order.status !== 'ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø²Ø¨ÙˆÙ†' && 
                order.status !== 'Ø±Ø§Ø¬Ø¹' && 
                order.status !== 'ØªÙ… Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹'
            );
            
            deliveredOrders = allOrders.filter(order => 
                order.status === 'ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø²Ø¨ÙˆÙ†'
            );
            
            returnedOrders = allOrders.filter(order => 
                order.status === 'Ø±Ø§Ø¬Ø¹' || order.status === 'ØªÙ… Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹'
            );
        }

        // Load orders by type
        function loadOrdersByType(type) {
            let ordersToDisplay = [];
            
            switch(type) {
                case 'pending':
                    ordersToDisplay = pendingOrders;
                    break;
                case 'delivered':
                    ordersToDisplay = deliveredOrders;
                    break;
                case 'returned':
                    ordersToDisplay = returnedOrders;
                    break;
            }
            
            displayOrdersByType(type, ordersToDisplay);
        }

        // Display orders by type
        function displayOrdersByType(type, orders) {
            const container = document.getElementById(type + 'OrdersContainer');
            const noOrders = document.getElementById('no' + type.charAt(0).toUpperCase() + type.slice(1) + 'Orders');

            if (orders.length === 0) {
                container.innerHTML = '';
                noOrders.classList.remove('hidden');
                return;
            }

            noOrders.classList.add('hidden');
            container.innerHTML = orders.map(order => {
                return `
                <div class="order-card bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow fade-in shadow-sm">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex-1">
                            <h4 class="font-bold text-lg text-gray-900">Ø·Ù„Ø¨ #${order.id}</h4>
                            <p class="text-gray-600">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${order.username || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                            <p class="text-gray-600">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¶Ø§ÙØ©: ${order.dateAdded ? new Date(order.dateAdded).toLocaleDateString('en-GB') : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                        </div>
                        <div class="flex space-x-2 space-x-reverse">
                            <button onclick="editOrder('${order.id}')" class="px-3 py-1 bg-purple-500 text-white rounded hover:bg-purple-600 text-sm">
                                ØªØ¹Ø¯ÙŠÙ„
                            </button>
                            <button onclick="deleteOrder('${order.id}')" class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm">
                                Ø­Ø°Ù
                            </button>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm">
                        <div>
                            <span class="font-medium text-gray-700">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</span>
                            <span class="text-gray-900">${order.address || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                        <div>
                            <span class="font-medium text-gray-700">Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø£ÙˆÙ„:</span>
                            <span class="text-gray-900">${order.phone1 || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                        <div>
                            <span class="font-medium text-gray-700">Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø«Ø§Ù†ÙŠ:</span>
                            <span class="text-gray-900">${order.phone2 || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                        <div>
                            <span class="font-medium text-gray-700">Ø§Ù„Ù…Ø¨Ù„Øº:</span>
                            <span class="text-gray-900">${order.amount || '0'} Ø¯ÙŠÙ†Ø§Ø±</span>
                        </div>
                        <div class="md:col-span-2">
                            <span class="font-medium text-gray-700 mb-2 block">Ø§Ù„Ø­Ø§Ù„Ø©:</span>
                            <div class="flex items-center space-x-2 space-x-reverse">
                                <select onchange="updateOrderStatus('${order.id}', this.value)" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-sm">
                                    <option value="Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨" ${order.status === 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨' ? 'selected' : ''}>Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</option>
                                    <option value="ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… Ù„Ù„Ù…Ù†Ø¯ÙˆØ¨" ${order.status === 'ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… Ù„Ù„Ù…Ù†Ø¯ÙˆØ¨' ? 'selected' : ''}>ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… Ù„Ù„Ù…Ù†Ø¯ÙˆØ¨</option>
                                    <option value="ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø²Ø¨ÙˆÙ†" ${order.status === 'ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø²Ø¨ÙˆÙ†' ? 'selected' : ''}>ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø²Ø¨ÙˆÙ†</option>
                                    <option value="Ø±Ø§Ø¬Ø¹" ${order.status === 'Ø±Ø§Ø¬Ø¹' ? 'selected' : ''}>Ø±Ø§Ø¬Ø¹</option>
                                    <option value="ØªÙ… Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹" ${order.status === 'ØªÙ… Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹' ? 'selected' : ''}>ØªÙ… Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹</option>
                                </select>
                                <span class="px-4 py-2 rounded-full text-sm font-bold ${getStatusColor(order.status)} shadow-sm border">
                                    ${getStatusIcon(order.status)} ${order.status || 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨'}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            }).join('');
        }

        // Update order status
        function updateOrderStatus(orderId, newStatus) {
            database.ref('orders/' + orderId).update({
                status: newStatus
            }).then(() => {
                // Reload orders to update categorization
                loadOrders();
            }).catch((error) => {
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨: ' + error.message);
            });
        }

        // Get status color
        function getStatusColor(status) {
            switch(status) {
                case 'ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø²Ø¨ÙˆÙ†': return 'bg-green-100 text-green-800 border-green-200';
                case 'ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… Ù„Ù„Ù…Ù†Ø¯ÙˆØ¨': return 'bg-blue-100 text-blue-800 border-blue-200';
                case 'Ø±Ø§Ø¬Ø¹': return 'bg-red-100 text-red-800 border-red-200';
                case 'ØªÙ… Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹': return 'bg-gray-100 text-gray-800 border-gray-200';
                default: return 'bg-yellow-100 text-yellow-800 border-yellow-200';
            }
        }

        // Get status icon
        function getStatusIcon(status) {
            switch(status) {
                case 'ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø²Ø¨ÙˆÙ†': return 'âœ…';
                case 'ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… Ù„Ù„Ù…Ù†Ø¯ÙˆØ¨': return 'ğŸšš';
                case 'Ø±Ø§Ø¬Ø¹': return 'â†©ï¸';
                case 'ØªÙ… Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹': return 'ğŸ”„';
                default: return 'â³';
            }
        }

        // Search orders
        function searchOrders(type) {
            const searchTerm = document.getElementById('search' + type.charAt(0).toUpperCase() + type.slice(1) + 'Input').value.toLowerCase().trim();
            let ordersToFilter = [];
            
            switch(type) {
                case 'pending':
                    ordersToFilter = pendingOrders;
                    break;
                case 'delivered':
                    ordersToFilter = deliveredOrders;
                    break;
                case 'returned':
                    ordersToFilter = returnedOrders;
                    break;
            }
            
            let filteredResults = [];
            if (!searchTerm) {
                filteredResults = [...ordersToFilter];
            } else {
                filteredResults = ordersToFilter.filter(order => 
                    (order.username && order.username.toLowerCase().includes(searchTerm)) ||
                    (order.address && order.address.toLowerCase().includes(searchTerm)) ||
                    (order.phone1 && order.phone1.includes(searchTerm)) ||
                    (order.phone2 && order.phone2.includes(searchTerm)) ||
                    (order.id && order.id.toLowerCase().includes(searchTerm))
                );
            }
            
            displayOrdersByType(type, filteredResults);
        }

        // Edit order
        function editOrder(orderId) {
            const order = allOrders.find(o => o.id === orderId);
            if (!order) return;

            document.getElementById('editOrderId').value = orderId;
            document.getElementById('editAddress').value = order.address || '';
            document.getElementById('editPhone1').value = order.phone1 || '';
            document.getElementById('editPhone2').value = order.phone2 || '';
            document.getElementById('editAmount').value = order.amount || '';

            document.getElementById('editModal').classList.remove('hidden');
            document.getElementById('editModal').classList.add('flex');
        }

        // Close edit modal
        function closeEditModal() {
            document.getElementById('editModal').classList.add('hidden');
            document.getElementById('editModal').classList.remove('flex');
        }

        // Delete order
        function deleteOrder(orderId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ØŸ')) {
                database.ref('orders/' + orderId).remove()
                    .then(() => {
                        alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
                    })
                    .catch((error) => {
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨: ' + error.message);
                    });
            }
        }

        // Handle edit form submission
        document.getElementById('editForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const orderId = document.getElementById('editOrderId').value;
            const updatedOrder = {
                address: document.getElementById('editAddress').value,
                phone1: document.getElementById('editPhone1').value,
                phone2: document.getElementById('editPhone2').value,
                amount: document.getElementById('editAmount').value
            };

            database.ref('orders/' + orderId).update(updatedOrder)
                .then(() => {
                    alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
                    closeEditModal();
                })
                .catch((error) => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨: ' + error.message);
                });
        });

        // Load users
        function loadUsers() {
            database.ref('users').on('value', (snapshot) => {
                allUsers = [];
                if (snapshot.exists()) {
                    snapshot.forEach((childSnapshot) => {
                        const user = {
                            id: childSnapshot.key,
                            ...childSnapshot.val()
                        };
                        allUsers.push(user);
                    });
                }
                displayUsers();
            });
        }

        // Display users
        function displayUsers() {
            const container = document.getElementById('usersContainer');
            
            if (allUsers.length === 0) {
                container.innerHTML = '<div class="text-center py-12"><div class="text-4xl sm:text-6xl mb-4">ğŸ‘¥</div><p class="text-gray-500 text-base sm:text-lg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p></div>';
                return;
            }

            container.innerHTML = allUsers.map(user => `
                <div class="bg-white border border-gray-200 rounded-lg p-4 shadow-sm">
                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-start space-y-3 sm:space-y-0">
                        <div class="flex-1">
                            <h4 class="font-bold text-base sm:text-lg text-gray-900">${user.username}</h4>
                            <p class="text-gray-600 text-sm">ID: ${user.id}</p>
                            <div class="mt-2 space-y-1 text-sm text-gray-600">
                                <p><span class="font-medium">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</span> ${user.address || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                                <p><span class="font-medium">Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø£ÙˆÙ„:</span> ${user.phone1 || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                                <p><span class="font-medium">Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø«Ø§Ù†ÙŠ:</span> ${user.phone2 || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                            </div>
                        </div>
                        <div class="flex space-x-2 space-x-reverse">
                            <button onclick="editUser('${user.id}')" class="px-3 py-1 bg-purple-500 text-white rounded hover:bg-purple-600 text-sm">
                                ØªØ¹Ø¯ÙŠÙ„
                            </button>
                            <button onclick="deleteUser('${user.id}')" class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm">
                                Ø­Ø°Ù
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Show add user modal
        function showAddUserModal() {
            document.getElementById('addUserModal').classList.remove('hidden');
            document.getElementById('addUserModal').classList.add('flex');
        }

        // Close add user modal
        function closeAddUserModal() {
            document.getElementById('addUserModal').classList.add('hidden');
            document.getElementById('addUserModal').classList.remove('flex');
            document.getElementById('addUserForm').reset();
        }

        // Handle add user form
        document.getElementById('addUserForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('newUsername').value;
            const password = document.getElementById('newPassword').value;
            const address = document.getElementById('newAddress').value;
            const phone1 = document.getElementById('newPhone1').value;
            const phone2 = document.getElementById('newPhone2').value;
            
            // Check if username already exists
            const existingUser = allUsers.find(user => user.username.toLowerCase() === username.toLowerCase());
            if (existingUser) {
                showErrorMessage('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„! ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… Ø¢Ø®Ø±.');
                return;
            }
            
            const newUser = {
                username: username,
                password: password,
                address: address,
                phone1: phone1,
                phone2: phone2
            };

            database.ref('users').push(newUser)
                .then(() => {
                    showSuccessMessage('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­! âœ…');
                    closeAddUserModal();
                })
                .catch((error) => {
                    showErrorMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ' + error.message);
                });
        });

        // Edit user
        function editUser(userId) {
            const user = allUsers.find(u => u.id === userId);
            if (!user) return;

            document.getElementById('editUserId').value = userId;
            document.getElementById('editUserUsername').value = user.username || '';
            document.getElementById('editUserPassword').value = user.password || '';
            document.getElementById('editUserAddress').value = user.address || '';
            document.getElementById('editUserPhone1').value = user.phone1 || '';
            document.getElementById('editUserPhone2').value = user.phone2 || '';

            document.getElementById('editUserModal').classList.remove('hidden');
            document.getElementById('editUserModal').classList.add('flex');
        }

        // Close edit user modal
        function closeEditUserModal() {
            document.getElementById('editUserModal').classList.add('hidden');
            document.getElementById('editUserModal').classList.remove('flex');
            document.getElementById('editUserForm').reset();
        }

        // Handle edit user form
        document.getElementById('editUserForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userId = document.getElementById('editUserId').value;
            const updatedUser = {
                username: document.getElementById('editUserUsername').value,
                password: document.getElementById('editUserPassword').value,
                address: document.getElementById('editUserAddress').value,
                phone1: document.getElementById('editUserPhone1').value,
                phone2: document.getElementById('editUserPhone2').value
            };

            database.ref('users/' + userId).update(updatedUser)
                .then(() => {
                    showSuccessMessage('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­! âœ…');
                    closeEditUserModal();
                })
                .catch((error) => {
                    showErrorMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ' + error.message);
                });
        });

        // Delete user
        function deleteUser(userId) {
            const user = allUsers.find(u => u.id === userId);
            const userName = user ? user.username : 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…';
            
            showConfirmModal(
                `Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… "${userName}"ØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.`, 
                function() {
                    database.ref('users/' + userId).remove()
                        .then(() => {
                            showSuccessMessage('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­! âœ…');
                            closeConfirmModal();
                        })
                        .catch((error) => {
                            showErrorMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ' + error.message);
                            closeConfirmModal();
                        });
                }
            );
        }

        // Load withdrawals
        function loadWithdrawals() {
            database.ref('withdrawals').on('value', (snapshot) => {
                allWithdrawals = [];
                if (snapshot.exists()) {
                    snapshot.forEach((childSnapshot) => {
                        const withdrawal = {
                            id: childSnapshot.key,
                            ...childSnapshot.val()
                        };
                        allWithdrawals.push(withdrawal);
                    });
                }
                displayWithdrawals();
            });
        }

        // Display withdrawals
        function displayWithdrawals() {
            const container = document.getElementById('withdrawalsContainer');
            const noWithdrawals = document.getElementById('noWithdrawals');

            if (allWithdrawals.length === 0) {
                container.innerHTML = '';
                noWithdrawals.classList.remove('hidden');
                return;
            }

            noWithdrawals.classList.add('hidden');
            
            // Sort withdrawals by date (newest first)
            const sortedWithdrawals = allWithdrawals.sort((a, b) => 
                new Date(b.dateRequested) - new Date(a.dateRequested)
            );

            container.innerHTML = sortedWithdrawals.map(withdrawal => {
                const statusColor = getWithdrawalStatusColor(withdrawal.status);
                return `
                <div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h4 class="font-bold text-lg text-gray-900">Ø·Ù„Ø¨ Ø³Ø­Ø¨ #${withdrawal.id}</h4>
                            <p class="text-gray-600">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${withdrawal.username}</p>
                            <p class="text-gray-600">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨: ${new Date(withdrawal.dateRequested).toLocaleDateString('ar-EG')}</p>
                        </div>
                        <div class="flex space-x-2 space-x-reverse">
                            ${withdrawal.status === 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©' ? `
                                <button onclick="updateWithdrawalStatus('${withdrawal.id}', 'ØªÙ… Ø§Ù„Ø¯ÙØ¹')" class="px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600 text-sm">
                                    Ù…ÙˆØ§ÙÙ‚Ø©
                                </button>
                                <button onclick="updateWithdrawalStatus('${withdrawal.id}', 'Ù…Ø±ÙÙˆØ¶')" class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm">
                                    Ø±ÙØ¶
                                </button>
                            ` : ''}
                            <button onclick="deleteWithdrawal('${withdrawal.id}')" class="px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 text-sm">
                                Ø­Ø°Ù
                            </button>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4">
                        <div>
                            <span class="font-medium text-gray-700">Ø§Ù„Ù…Ø¨Ù„Øº:</span>
                            <span class="text-gray-900">${withdrawal.amount.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</span>
                        </div>
                        <div>
                            <span class="font-medium text-gray-700">Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª:</span>
                            <span class="text-gray-900">${withdrawal.ordersCount}</span>
                        </div>
                        <div>
                            <span class="font-medium text-gray-700">Ø§Ù„Ø­Ø§Ù„Ø©:</span>
                            <span class="px-3 py-1 rounded-full text-xs font-medium ${statusColor}">
                                ${withdrawal.status}
                            </span>
                        </div>
                    </div>
                </div>
            `;
            }).join('');
        }

        // Get withdrawal status color
        function getWithdrawalStatusColor(status) {
            switch(status) {
                case 'ØªÙ… Ø§Ù„Ø¯ÙØ¹': return 'bg-green-100 text-green-800';
                case 'Ù…Ø±ÙÙˆØ¶': return 'bg-red-100 text-red-800';
                case 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©': return 'bg-yellow-100 text-yellow-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        // Update withdrawal status
        function updateWithdrawalStatus(withdrawalId, newStatus) {
            database.ref('withdrawals/' + withdrawalId).update({
                status: newStatus
            }).then(() => {
                alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
            }).catch((error) => {
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨: ' + error.message);
            });
        }

        // Show confirmation modal
        function showConfirmModal(message, onConfirm) {
            document.getElementById('confirmMessage').textContent = message;
            document.getElementById('confirmButton').onclick = onConfirm;
            document.getElementById('confirmModal').classList.remove('hidden');
            document.getElementById('confirmModal').classList.add('flex');
        }

        // Close confirmation modal
        function closeConfirmModal() {
            document.getElementById('confirmModal').classList.add('hidden');
            document.getElementById('confirmModal').classList.remove('flex');
        }

        // Show success message
        function showSuccessMessage(message) {
            document.getElementById('successMessage').textContent = message;
            document.getElementById('successModal').classList.remove('hidden');
            document.getElementById('successModal').classList.add('flex');
            
            // Auto close after 3 seconds
            setTimeout(() => {
                closeSuccessModal();
            }, 3000);
        }

        // Close success modal
        function closeSuccessModal() {
            document.getElementById('successModal').classList.add('hidden');
            document.getElementById('successModal').classList.remove('flex');
        }

        // Show error message
        function showErrorMessage(message) {
            document.getElementById('errorMessage').textContent = message;
            document.getElementById('errorModal').classList.remove('hidden');
            document.getElementById('errorModal').classList.add('flex');
        }

        // Close error modal
        function closeErrorModal() {
            document.getElementById('errorModal').classList.add('hidden');
            document.getElementById('errorModal').classList.remove('flex');
        }

        // Delete withdrawal (admin view only)
        function deleteWithdrawal(withdrawalId) {
            showConfirmModal('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ù‡Ø°Ø§ØŸ', function() {
                // Remove from admin withdrawals array only
                allWithdrawals = allWithdrawals.filter(w => w.id !== withdrawalId);
                displayWithdrawals();
                alert('ØªÙ… Ø­Ø°Ù Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ù…Ù† Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø¯Ù…Ù† Ø¨Ù†Ø¬Ø§Ø­');
                closeConfirmModal();
            });
        }

        // Update statistics
        function updateStatistics() {
            const totalOrders = allOrders.length;
            const deliveredCount = allOrders.filter(order => order.status === 'ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø²Ø¨ÙˆÙ†').length;
            const returnedCount = allOrders.filter(order => order.status === 'Ø±Ø§Ø¬Ø¹' || order.status === 'ØªÙ… Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹').length;

            document.getElementById('totalOrders').textContent = totalOrders;
            document.getElementById('deliveredOrders').textContent = deliveredCount;
            document.getElementById('returnedOrders').textContent = returnedCount;
        }

        // Handle search on Enter key for all sections
        document.getElementById('searchPendingInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchOrders('pending');
            }
        });
        
        document.getElementById('searchDeliveredInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchOrders('delivered');
            }
        });
        
        document.getElementById('searchReturnedInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchOrders('returned');
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97885980907d5160',t:'MTc1Njc2NzI2OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
